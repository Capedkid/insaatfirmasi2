@model InsaatFirmasi.Models.BlogPost
@{
    var seoTitle = !string.IsNullOrEmpty(Model.SeoTitle) ? Model.SeoTitle : Model.Title;
    var baseDescription = Model.SeoDescription ?? Model.Summary ?? Model.Content;
    var description = baseDescription != null && baseDescription.Length > 160
        ? baseDescription.Substring(0, 160) + "..."
        : baseDescription;
    var keywords = !string.IsNullOrEmpty(Model.SeoKeywords)
        ? Model.SeoKeywords
        : $"{Model.Title}, {Model.Tags}, blog, inşaat malzemeleri";

    ViewData["Title"] = seoTitle;
    ViewData["Description"] = description;
    ViewData["Keywords"] = keywords;
    ViewData["OgTitle"] = seoTitle;
    ViewData["OgDescription"] = description;
}

<!-- SAYFA HERO (diğer sayfalarla aynı yapı) -->
<section class="page-hero page-hero-simple">
    <div class="container-xl text-center">
        <h1 class="page-hero-title">@Model.Title</h1>
    </div>
</section>

<!-- Blog Yazısı Header -->
<section class="home-section">
    <div class="container-xl">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <!-- Kategori ve Tarih -->
                <div class="text-center mb-4">
                    @if (!string.IsNullOrWhiteSpace(Model.Category))
                    {
                        <span class="badge bg-danger fs-6 mb-3">@Model.Category</span>
                    }
                    <div class="d-flex justify-content-center align-items-center text-muted">
                        <i class="fas fa-calendar me-2"></i>
                        <span>
                            @(Model.PublishedDate?.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")) 
                              ?? Model.CreatedDate.ToString("dd MMMM yyyy", new System.Globalization.CultureInfo("tr-TR")))
                        </span>
                        <i class="fas fa-eye ms-4 me-2"></i>
                        <span>@Model.ViewCount görüntülenme</span>
                        <i class="fas fa-clock ms-4 me-2"></i>
                        <span>@Model.ReadTime dakika okuma</span>
                    </div>
                </div>
                
                <!-- Ana Görsel -->
                @if (!string.IsNullOrEmpty(Model.ImagePath) || !string.IsNullOrEmpty(Model.ImageUrl))
                {
                    <div class="text-center mb-5">
                        @if (!string.IsNullOrEmpty(Model.ImagePath))
                        {
                            <img src="~/@Model.ImagePath"
                                 class="img-fluid rounded shadow-lg"
                                 alt="@Model.Title"
                                 style="max-height: 400px; width: 100%; object-fit: cover;">
                        }
                        else
                        {
                            <img src="@Model.ImageUrl"
                             class="img-fluid rounded shadow-lg" 
                             alt="@Model.Title"
                             style="max-height: 400px; width: 100%; object-fit: cover;">
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</section>

<!-- Blog İçeriği -->
<section class="pb-5">
    <div class="container-xl">
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="blog-content">
                    @Html.Raw(Model.Content?.Replace("\n", "<br>"))
                </div>
                
                <!-- Etiketler -->
                @if (!string.IsNullOrEmpty(Model.Tags))
                {
                    <div class="mt-5">
                        <h6 class="fw-bold text-dark mb-3">Etiketler</h6>
                        <div class="d-flex flex-wrap gap-2">
                            @foreach (var tag in Model.Tags.Split(',').Where(t => !string.IsNullOrWhiteSpace(t)))
                            {
                                <span class="badge bg-light text-dark border">@tag.Trim()</span>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</section>

<!-- İlgili Yazılar ve iletişim CTA bölümleri kaldırıldı -->

@section Scripts {
    <script>
        // Yazı okunduğunda görüntülenme sayısını artır
        document.addEventListener('DOMContentLoaded', function() {
            // Sayfa yüklendiğinde görüntülenme sayısını artır
            fetch('@Url.Action("IncrementViewCount", "Blog", new { id = Model.Id })', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            });
        });
    </script>
}

<style>
    .blog-content {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #333;
    }
    
    .blog-content h1, .blog-content h2, .blog-content h3, .blog-content h4, .blog-content h5, .blog-content h6 {
        color: #dc3545;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }
    
    .blog-content p {
        margin-bottom: 1.5rem;
    }
    
    .blog-content img {
        max-width: 100%;
        height: auto;
        border-radius: 8px;
        margin: 1rem 0;
    }
    
    .blog-content ul, .blog-content ol {
        margin-bottom: 1.5rem;
        padding-left: 2rem;
    }
    
    .blog-content li {
        margin-bottom: 0.5rem;
    }
    
    .blog-content blockquote {
        border-left: 4px solid #dc3545;
        padding-left: 1rem;
        margin: 1.5rem 0;
        font-style: italic;
        color: #666;
    }
    
    .blog-content code {
        background-color: #f8f9fa;
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
    }
    
    .blog-content pre {
        background-color: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        overflow-x: auto;
        margin: 1.5rem 0;
    }
</style>
